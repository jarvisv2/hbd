<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Birthday Surprise!</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* --- Animations (loader) --- */
    @keyframes float { 0%{transform:translate(0,0)rotate(0deg)scale(1);} 50%{transform:translate(var(--dx,0px),-20px)rotate(var(--rot,0deg))scale(1.1);} 100%{transform:translate(0,0)rotate(0deg)scale(1);} }
    @keyframes bounceHeart { 0%,100%{transform:translateY(0)scale(1);} 50%{transform:translateY(-15px)scale(1.2);} }
    @keyframes pulseScale { 0%,100%{transform:scale(1);} 50%{transform:scale(1.05);} }
    @keyframes wiggleFloat { 0%,100%{transform:rotate(-10deg)translateY(0)scale(1);} 50%{transform:rotate(10deg)translateY(-5px)scale(1.2);} }
    .floating { animation:float var(--dur,4s) ease-in-out infinite alternate; }
    .bounce { animation:bounceHeart 1s infinite; }
    .pulse { animation:pulseScale 2s infinite; }
    .wiggle { animation:wiggleFloat var(--dur,2s) ease-in-out infinite; cursor:pointer; }
    .icon-fill svg { fill:currentColor; }
    @keyframes vanishOut { to { opacity:0; transform:scale(0.7) translateY(-10px); filter:blur(2px);} }
    .vanish { animation:vanishOut 0.4s ease forwards; }
    /* --- Animations (countdown) --- */
    @keyframes floatHeart { 0%{transform:translateY(0)translateX(0)rotate(0deg)scale(1);} 50%{transform:translateY(-20px)translateX(var(--random-x,0px))rotate(var(--random-rot,0deg))scale(1.1);} 100%{transform:translateY(0)translateX(0)rotate(0deg)scale(1);} }
    @keyframes pulseScaleMirror {0%{transform:scale(0.95);} 100%{transform:scale(1);} }
    @keyframes fadeUp {0%{transform:translateY(20px);opacity:0;} 100%{transform:translateY(0);opacity:1;} }
    @keyframes dotPulse {0%{transform:scale(1);opacity:0.7;}50%{transform:scale(1.5);opacity:1;}100%{transform:scale(1);opacity:0.7;} }
    @keyframes hoverWiggle {0%{transform:rotate(-1deg);}33%{transform:rotate(1deg);}66%{transform:rotate(-1deg);}100%{transform:rotate(0deg);} }
    .floating-heart {animation:floatHeart var(--duration,4s) ease-in-out infinite alternate; animation-delay:var(--delay,0s);}
    .pulse-mirror {animation:pulseScaleMirror 1.5s ease-in-out infinite alternate;}
    .fade-up {animation:fadeUp 0.5s ease-out both;}
    .hover-wiggle:hover {animation:hoverWiggle 0.4s ease-in-out;transform:scale(1.05);}
    .dot {width:0.75rem;height:0.75rem;border-radius:9999px;background-color:rgb(244 114 182);animation:dotPulse 1s infinite;}
    .icon-fill svg { fill: currentColor; }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-b from-rose-100 to-purple-100 overflow-hidden">

<!-- SPA root wrapper -->
<div id="app"></div>

<script src="https://unpkg.com/lucide@latest"></script>
<script>
/* Persistent Music: start ONCE, never stop, never restart */
(function(){
  const MUSIC_SRC = "https://raw.githubusercontent.com/jarvisv2/hbd/main/music/barbaad.mp3"; // CHANGE THIS!
  if (!window.persistentAudio) {
    window.persistentAudio = new Audio(MUSIC_SRC);
    window.persistentAudio.loop = true;
    window.persistentAudio.volume = 0.6;
    window.persistentAudio.preload = "auto";
    let playPromise = window.persistentAudio.play();
    if (playPromise !== undefined) {
      playPromise.catch(function(error) {
        document.addEventListener('click', function() {
          window.persistentAudio.play();
        }, { once:true });
      });
    }
  }
})();

/* --- SPA PAGE RENDERERS --- */
const app = document.getElementById("app");

// --- Page 1: Loader/Emoji ---
function showLoaderPage() {
  app.innerHTML = `
    <div id="bg-icons" class="fixed inset-0 overflow-hidden pointer-events-none"></div>
    <div class="flex items-center justify-center min-h-screen">
      <div class="relative z-10 bg-white/80 backdrop-blur-sm rounded-3xl shadow-lg shadow-rose-100 p-8 border-4 border-pink-200 flex flex-col items-center max-w-xs mx-auto">
        <div class="flex justify-center space-x-3 mb-5">
          <i data-lucide="heart" class="w-8 h-8 text-pink-400 icon-fill" style="animation:bounceHeart 1s infinite; animation-delay:0s;"></i>
          <i data-lucide="heart" class="w-8 h-8 text-pink-500 icon-fill" style="animation:bounceHeart 1s infinite; animation-delay:.2s;"></i>
          <i data-lucide="heart" class="w-8 h-8 text-purple-400 icon-fill" style="animation:bounceHeart 1s infinite; animation-delay:.4s;"></i>
        </div>
        <p class="text-xl font-bold text-center text-pink-600 mb-3" style="animation:pulseScale 2s infinite;">
          Loading something special...
        </p>
        <div id="emoji-row" class="flex justify-center space-x-4 mt-5 text-xl">
          <span class="wiggle" data-emoji style="--dur:2s; animation-delay:0s;">üéÇ</span>
          <span class="wiggle" data-emoji style="--dur:2s; animation-delay:.2s;">‚ú®</span>
          <span class="wiggle" data-emoji style="--dur:2s; animation-delay:.4s;">üéÅ</span>
          <span class="wiggle" data-emoji style="--dur:2s; animation-delay:.6s;">üíñ</span>
          <span class="wiggle" data-emoji style="--dur:2s; animation-delay:.8s;">üéà</span>
        </div>
      </div>
    </div>
  `;
  // Floating background
  const container = document.getElementById('bg-icons');
  const count = 20;
  for (let i = 0; i < count; i++) {
    const wrapper = document.createElement('span');
    wrapper.className = 'absolute floating';
    wrapper.style.left = Math.random() * 100 + '%';
    wrapper.style.top = Math.random() * 100 + '%';
    wrapper.style.setProperty('--dur', (3 + Math.random() * 3) + 's');
    wrapper.style.setProperty('--dx', (Math.random() * 20 - 10) + 'px');
    wrapper.style.setProperty('--rot', (Math.random() * 10 - 5) + 'deg');
    wrapper.style.animationDelay = (Math.random() * 2) + 's';
    const size = 4 + (i % 4);
    const which = (i % 5 === 0) ? 'star' : (i % 5 === 1 ? 'sparkles' : 'heart');
    const icon = document.createElement('i');
    icon.setAttribute('data-lucide', which);
    icon.className = `w-${size} h-${size} opacity-70`;
    if (which === 'star') icon.classList.add('text-yellow-300','fill-yellow-100','icon-fill');
    else if (which === 'sparkles') icon.classList.add('text-purple-300');
    else {
      if (i % 3 === 0) icon.classList.add('text-pink-300');
      else if (i % 3 === 1) icon.classList.add('text-pink-400');
      else icon.classList.add('text-purple-300');
      icon.classList.add(i % 2 === 0 ? 'fill-pink-100' : 'fill-pink-200','icon-fill');
    }
    wrapper.appendChild(icon);
    container.appendChild(wrapper);
  }
  lucide.createIcons();

  // emoji click logic
  const emojiSpans = document.querySelectorAll('#emoji-row [data-emoji]');
  let clickedCount = 0;
  emojiSpans.forEach(span => {
    span.addEventListener('click', function(e) {
      if (span.classList.contains('vanish')) return;
      span.classList.add('vanish');
      span.style.pointerEvents = 'none';
      clickedCount++;
      if (clickedCount === emojiSpans.length) {
        setTimeout(showCountdownPage, 500);
      }
    });
  });
}

// --- Page 2: Countdown ---
function showCountdownPage() {
  ` <div id="bg-hearts" class="fixed inset-0 overflow-hidden pointer-events-none"></div>
    <div class="flex items-center justify-center min-h-screen">
      <div class="relative z-10 bg-white/80 backdrop-blur-sm rounded-3xl shadow-lg shadow-rose-100 p-8 border-4 border-pink-200 max-w-2xl mx-4">
        <div class="flex flex-col items-center justify-center">
          <h1 class="text-3xl md:text-4xl font-bold text-center text-pink-600 min-h-20 sm:min-h-11 mb-6 pulse-mirror">
            Your Special Day is Almost Hereüíï
          </h1>
          <div id="cards" class="flex flex-wrap justify-center gap-4 mb-8">
            <div class="bg-white rounded-3xl shadow-lg p-4 w-28 h-28 flex flex-col items-center justify-center border-2 border-pink-200 fade-up hover-wiggle" style="animation-delay:0s;">
              <div id="days-value" class="text-3xl font-bold text-purple-600">0</div>
              <div class="text-sm text-pink-500 capitalize">days</div>
              <div class="mt-1"><i data-lucide="heart" class="text-pink-500 icon-fill"></i></div>
            </div>
            <div class="bg-white rounded-3xl shadow-lg p-4 w-28 h-28 flex flex-col items-center justify-center border-2 border-pink-200 fade-up hover-wiggle" style="animation-delay:.1s;">
              <div id="hours-value" class="text-3xl font-bold text-purple-600">0</div>
              <div class="text-sm text-pink-500 capitalize">hours</div>
              <div class="mt-1"><i data-lucide="gift" class="text-purple-500"></i></div>
            </div>
            <div class="bg-white rounded-3xl shadow-lg p-4 w-28 h-28 flex flex-col items-center justify-center border-2 border-pink-200 fade-up hover-wiggle" style="animation-delay:.2s;">
              <div id="minutes-value" class="text-3xl font-bold text-purple-600">0</div>
              <div class="text-sm text-pink-500 capitalize">minutes</div>
              <div class="mt-1"><i data-lucide="cake" class="text-pink-500"></i></div>
            </div>
            <div class="bg-white rounded-3xl shadow-lg p-4 w-28 h-28 flex flex-col items-center justify-center border-2 border-pink-200 fade-up hover-wiggle" style="animation-delay:.3s;">
              <div id="seconds-value" class="text-3xl font-bold text-purple-600">5</div>
              <div class="text-sm text-pink-500 capitalize">seconds</div>
              <div class="mt-1"><i data-lucide="star" class="text-yellow-400 icon-fill"></i></div>
            </div>
          </div>
          <div class="text-center max-w-md mx-auto bg-pink-50 p-4 rounded-3xl border-2 border-pink-100 fade-up" style="animation-delay: 0.5s;">
            <p class="text-lg text-purple-700 mb-4">
              Just a little more... A small gift for my favorite person‚ù§Ô∏è
            </p>
            <div class="flex justify-center space-x-2">
              <span class="dot" style="animation-delay: 0s;"></span>
              <span class="dot" style="animation-delay: .3s;"></span>
              <span class="dot" style="animation-delay: .6s;"></span>
            </div>
          </div>
        </div>
      </div>
    </div>
  `;
  // Hearts bg
  const heartsContainer = document.getElementById('bg-hearts');
  const heartCount = 20;
  for (let i = 0; i < heartCount; i++) {
    const heart = document.createElement('div');
    heart.className = 'absolute floating-heart opacity-70';
    heart.style.left = Math.random() * 100 + '%';
    heart.style.top = Math.random() * 100 + '%';
    heart.style.setProperty('--duration', (3 + Math.random() * 3) + 's');
    heart.style.setProperty('--delay', Math.random() * 2 + 's');
    heart.style.setProperty('--random-x', (Math.random() * 20 - 10) + 'px');
    heart.style.setProperty('--random-rot', (Math.random() * 10 - 5) + 'deg');
    const icon = document.createElement('i');
    icon.setAttribute('data-lucide', 'heart');
    const size = 4 + (i % 4);
    icon.className = `w-${size} h-${size} icon-fill`;
    if (i % 3 === 0) icon.classList.add('text-pink-300','fill-pink-100');
    else if (i % 3 === 1) icon.classList.add('text-pink-400','fill-pink-200');
    else icon.classList.add('text-purple-300','fill-purple-100');
    heart.appendChild(icon);
    heartsContainer.appendChild(heart);
  }
  lucide.createIcons();

  // Countdown logic
  let totalSeconds = 5;
  const daysEl = document.getElementById('days-value');
  const hoursEl = document.getElementById('hours-value');
  const minutesEl = document.getElementById('minutes-value');
  const secondsEl = document.getElementById('seconds-value');
  const cardsEl = document.getElementById('cards');
  function renderDHMS(total) {
    const days = Math.floor(total / 86400);
    const hours = Math.floor((total % 86400) / 3600);
    const minutes = Math.floor((total % 3600) / 60);
    const seconds = total % 60;
    daysEl.textContent = days;
    hoursEl.textContent = hours;
    minutesEl.textContent = minutes;
    secondsEl.textContent = seconds;
  }
  function showSurpriseButton() {
    cardsEl.innerHTML = '<button id="surprise-btn" class="mt-2 bg-pink-500 text-white font-semibold py-3 px-5 rounded-2xl hover:bg-pink-600 focus:outline-none focus:ring-2 focus:ring-pink-300">üéâ Surprise! The wait is over! üéÅ</button>';
    document.getElementById('surprise-btn').addEventListener('click', function() {
      showBirthdayPage();
    });
  }
  renderDHMS(totalSeconds);
  const timer = setInterval(() => {
    totalSeconds -= 1;
    if (totalSeconds <= 0) {
      clearInterval(timer);
      renderDHMS(0);
      showSurpriseButton();
    } else {
      renderDHMS(totalSeconds);
    }
  }, 1000);
}

// --- Page 3: Birthday page (demo content) ---
function showBirthdayPage() {
  app.innerHTML = `
<!-- Cake with candles spelling "Supriya" + soft pink quote -->
<div id="cake-intro" aria-hidden="true">
¬† <div class="ci-stage" role="img" aria-label="Beautiful birthday cake with candles spelling Supriya">
¬† ¬† <svg class="ci-cake" viewBox="0 0 380 280" width="400" height="300" aria-hidden="true">
¬† ¬† ¬† <!-- ...cake SVG code... (unchanged) ... -->
¬† ¬† </svg>
¬† ¬† <div class="ci-knife" aria-hidden="true">
¬† ¬† ¬† <span class="ci-blade"></span>
¬† ¬† ¬† <span class="ci-handle"></span>
¬† ¬† </div>
¬† ¬† <button class="ci-cut-btn" id="ci-cut-btn">Cut Cake üç∞</button>
¬† ¬† <div class="cake-quote">Wishing you joy &amp; love!</div>
¬† </div>
¬† <button id="ci-skip" class="ci-skip" type="button">Skip</button>
</div>

<div id="wrapper">
¬† ¬† <!-- ...flag, decorations, letter, balloons, etc... (unchanged) ... -->
</div>

<div id="copy">
¬† ¬† <p class="text-center text-white text-sm">Instagram <a
¬† ¬† ¬† ¬† href="https://www.instagram.com/aoudumber.dev/reels/#">@darkshadeoflove</a></p>
</div>
¬†
<!-- You must re-initialize scripts after SPA injection! -->
¬†
<script>
(function(){
¬† const intro = document.getElementById('cake-intro');
¬† if(!intro) return;
¬† const cutBtn = document.getElementById('ci-cut-btn');
¬† const quote = intro.querySelector('.cake-quote');
¬† function burst(n=30){
¬† ¬† const colors=['#fe8dc6','#fbbf24','#a3e635','#60b5fa','#ab8bfa','#f782b6'];
¬† ¬† for(let i=0;i<n;i++){
¬† ¬† ¬† const s=document.createElement('span');
¬† ¬† ¬† s.className='confetti';
¬† ¬† ¬† s.style.background = colors[i % colors.length];
¬† ¬† ¬† s.style.setProperty('--x', (Math.random()*260-130)+'px');
¬† ¬† ¬† s.style.setProperty('--d', (1.3+Math.random()*0.8).toFixed(2)+'s');
¬† ¬† ¬† s.style.setProperty('--dl', (0.05+Math.random()*0.35).toFixed(2)+'s');
¬† ¬† ¬† intro.appendChild(s);
¬† ¬† ¬† setTimeout(()=>s.remove(), 2100);
¬† ¬† }
¬† }
¬† function playCut(){
¬† ¬† cutBtn.style.display="none";
¬† ¬† intro.classList.add('ci-cut');
¬† ¬† burst(30);
¬† ¬† setTimeout(()=>{intro.classList.add('ci-quote');},950);
¬† ¬† setTimeout(hide, 2600);
¬† }
¬† function hide(){
¬† ¬† intro.classList.add('ci-fade-out');
¬† ¬† setTimeout(()=>intro.remove(), 800);
¬† }
¬† cutBtn.addEventListener('click', playCut);
¬† document.getElementById('ci-skip').addEventListener('click', hide);
})();
</script>

<script>
¬† ¬† let datetxt = "2 Nov ¬†1999";
¬† ¬† let datatxtletter = "Happy birthday to the most beautiful, special girl in my heart. May your birthday be as beautiful and special as you are. Wishing you all the happiness your heart can hold on your special day.üíï";
¬† ¬† let titleLetter = "To you";
¬† ¬† let charArrDate = datetxt.split('');
¬† ¬† let charArrDateLetter = datatxtletter.split('');
¬† ¬† let charArrTitle = titleLetter.split('');
¬† ¬† let currentIndex = 0;
¬† ¬† let currentIndexLetter = 0;
¬† ¬† let currentIndexTitle = 0;
¬† ¬† let date__of__birth = document.querySelector(".date__of__birth span");
¬† ¬† let text__letter = document.querySelector(".text__letter p");
¬† ¬† setTimeout(function(){
¬† ¬† ¬† ¬† timeDatetxt = setInterval(function(){
¬† ¬† ¬† ¬† ¬† ¬† if(currentIndex < charArrDate.length){
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† date__of__birth.textContent += charArrDate[currentIndex];
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† currentIndex++;
¬† ¬† ¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† ¬† ¬† else{
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† let i = document.createElement("i");
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† i.className = "fa-solid fa-star"
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† document.querySelector(".date__of__birth").prepend(i)
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† document.querySelector(".date__of__birth").appendChild(i.cloneNode(true))
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† clearInterval(timeDatetxt)
¬† ¬† ¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† },100)
¬† ¬† },12000)

¬† ¬† var intervalContent;
¬† ¬† var intervalTitle;
¬† ¬† $("#btn__letter").on("click", function(){
¬† ¬† ¬† ¬† $(".box__letter").slideDown()
¬† ¬† ¬† ¬† setTimeout(function(){
¬† ¬† ¬† ¬† ¬† ¬† $(".letter__border").slideDown();
¬† ¬† ¬† ¬† },1000)
¬† ¬† ¬† ¬† setTimeout(function(){
¬† ¬† ¬† ¬† ¬† ¬† intervalTitle = setInterval(function(){
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† if(currentIndexTitle < charArrTitle.length){
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† document.querySelector(".title__letter").textContent += charArrTitle[currentIndexTitle];
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† let i = document.createElement("i");
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† i.className = "fa-solid fa-heart"
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† document.querySelector(".title__letter").appendChild(i)
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† currentIndexTitle++;
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† else{
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† clearInterval(intervalTitle)
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† ¬† ¬† },100)
¬† ¬† ¬† ¬† },2000)
¬† ¬† ¬† ¬† setTimeout(function(){
¬† ¬† ¬† ¬† ¬† ¬† document.querySelector("#heart__letter").classList.add("animationOp");
¬† ¬† ¬† ¬† ¬† ¬† document.querySelector(".love__img").classList.add("animationOp");
¬† ¬† ¬† ¬† ¬† ¬† document.querySelector("#mewmew").classList.add("animationOp");
¬† ¬† ¬† ¬† },2800)
¬† ¬† ¬† ¬† setTimeout(function(){
¬† ¬† ¬† ¬† ¬† ¬† document.querySelectorAll(".heart").forEach((item)=>{
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† item.classList.add("animation")
¬† ¬† ¬† ¬† ¬† ¬† })
¬† ¬† ¬† ¬† },3500)
¬† ¬† ¬† ¬† setTimeout(function(){
¬† ¬† ¬† ¬† ¬† ¬† intervalContent = setInterval(function(){
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† if(currentIndexLetter < charArrDateLetter.length){
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† text__letter.textContent += charArrDateLetter[currentIndexLetter];
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† currentIndexLetter++;
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† else{
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† clearInterval(intervalContent)
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† }
¬† ¬† ¬† ¬† ¬† ¬† },50)
¬† ¬† ¬† ¬† },6000)
¬† ¬† })
¬† ¬† $(".close").on("click", function(){
¬† ¬† ¬† ¬† clearInterval(intervalContent)
¬† ¬† ¬† ¬† document.querySelector(".title__letter").textContent = "";
¬† ¬† ¬† ¬† text__letter.textContent = "";
¬† ¬† ¬† ¬† currentIndexLetter = 0
¬† ¬† ¬† ¬† currentIndexTitle = 0
¬† ¬† ¬† ¬† document.querySelector("#heart__letter").classList.remove("animationOp");
¬† ¬† ¬† ¬† document.querySelector(".love__img").classList.remove("animationOp");
¬† ¬† ¬† ¬† document.querySelector("#mewmew").classList.remove("animationOp");
¬† ¬† ¬† ¬† document.querySelectorAll(".heart").forEach((item)=>{
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† item.classList.remove("animation")
¬† ¬† ¬† ¬† ¬† ¬† })
¬† ¬† ¬† ¬† $(".box__letter").slideUp();
¬† ¬† ¬† ¬† $(".letter__border").slideUp();
¬† ¬† })
</script>
  `;
  // If your page uses external CSS/JS (jQuery, FontAwesome, GoogleFonts), add their <link> and <script> tags to the SPA's <head> only ONCE (not inside this function, but in the main HTML file).
}
